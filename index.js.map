{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryList = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadButton = document.querySelector('.load-more-button');\nconst lightbox = new SimpleLightbox('.gallery a');\n\nexport function createGallery(images) {\n    const markup = images\n    .map(\n        ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        }) =>\n        `<li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"> \n            </a>\n            <div class=\"gallery-bottom-wrapper\">\n                <div class=\"gallery-inner-wrapper\">\n                    <p class=\"gallery-wrapper-title\">Likes</p>\n                    <p class=\"gallery-wrapper-value\">${likes}</p>\n                    </div>\n                    <div class=\"gallery-inner-wrapper\">\n                        <p class=\"gallery-wrapper-title\">Views</p>\n                        <p class=\"gallery-wrapper-value\">${views}</p>\n                        </div>\n                        <div class=\"gallery-inner-wrapper\">\n                            <p class=\"gallery-wrapper-title\">Comments</p>\n                            <p class=\"gallery-wrapper-value\">${comments}</p>\n                            </div>\n                            <div class=\"gallery-inner-wrapper\">\n                                <p class=\"gallery-wrapper-title\">Downloads</p>\n                                <p class=\"gallery-wrapper-value\">${downloads}</p>\n                                </div>\n                                </div>\n                                </li>`\n    )\n    .join('');\n    galleryList.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n    }\n    export function clearGallery() {\n    galleryList.innerHTML = '';\n    }\n    export function showLoader() {\n    loader.classList.remove('hiden');\n    }\n    export function hideLoader() {\n    loader.classList.add('hiden');\n    }\n    export function showLoadMoreButton() {\n    loadButton.classList.remove('hiden');\n    }\n    export function hideLoadMoreButton() {\n    loadButton.classList.add('hiden');\n}","import axios from 'axios';\n\nconst BASEURL = 'https://pixabay.com/api/';\nconst API = '54348256-4fe7e6271296be96900661c2d';\nexport const PER_PAGE = 15;\n\n    export async function getImagesByQuery(query, page) {\n    const { data } = await axios.get(BASEURL, {\n    params: {\n        key: API,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page: PER_PAGE,\n    },\n    });\n    return data;\n    }","    import iziToast from 'izitoast';\n    import 'izitoast/dist/css/iziToast.min.css';\n    import {\n    createGallery,\n    clearGallery,\n    showLoader,\n    hideLoader,\n    showLoadMoreButton,\n    hideLoadMoreButton,\n    } from './js/render-functions';\n    import { getImagesByQuery } from './js/pixabay-api';\n    import { PER_PAGE } from './js/pixabay-api';\n\n    const form = document.querySelector('form');\n    const userInput = document.querySelector('input');\n    const loadMoreButton = document.querySelector('.load-more-button');\n\n\n\n    // Оголошуємо змінні явно\n    let page = 1;\n    let currentQuery = '';\n    let totalHits = 0;          // ← виправлено: явне оголошення\n\n\n\n    form.addEventListener('submit', handleFormSubmit);\n    loadMoreButton.addEventListener('click', handleLoadMore);\n\n    async function handleFormSubmit(event) {\n    event.preventDefault();\n    const newQuery = userInput.value.trim();\n\n    if (!newQuery) {\n        iziToast.info({ message: 'Введіть запит для пошуку зображень' });\n        return;\n    }\n\n    if (newQuery === currentQuery) {\n        iziToast.info({ message: 'Такий самий запит уже виконано', timeout: 2200 });\n        return;\n    }\n\n    currentQuery = newQuery;\n    page = 1;\n    totalHits = 0;\n\n    clearGallery();\n    hideLoadMoreButton();\n    await renderGallery();\n    }\n\n    async function handleLoadMore() {\n    page += 1;\n    hideLoadMoreButton();\n    await renderGallery();\n    }\n\n    async function renderGallery() {\n    showLoader();\n\n    try {\n        const response = await getImagesByQuery(currentQuery, page);\n        const { hits, totalHits: newTotal } = response;\n\n        // Зберігаємо загальну кількість тільки при першому запиті\n        if (page === 1) {\n        totalHits = newTotal;\n        }\n\n        if (hits.length === 0) {\n        if (page === 1) {\n            iziToast.warning({\n            message: 'За вашим запитом нічого не знайдено. Спробуйте інший запит.',\n            });\n        }\n        hideLoadMoreButton();\n        return;\n        }\n\n        createGallery(hits);\n\n        if (page > 1) {\n        smoothScroll();\n        }\n\n\n        \n        // Логіка показу/ховання кнопки \"Завантажити ще\"\n        const alreadyLoaded = PER_PAGE * page;\n\n        if (alreadyLoaded >= totalHits) {\n        hideLoadMoreButton();\n        if (totalHits > 0) {\n            iziToast.info({\n            message: 'Ви переглянули всі доступні зображення',\n            timeout: 4000,\n            });\n        }\n        } else {\n        showLoadMoreButton();\n        }\n\n    } catch (error) {\n        console.error('Помилка завантаження зображень:', error);\n\n        iziToast.error({\n        title: 'Помилка',\n        message: 'Не вдалося завантажити зображення. Перевірте підключення або спробуйте пізніше.',\n        timeout: 5000,\n        position: 'topRight',\n        });\n\n        hideLoadMoreButton();\n    } finally {\n        hideLoader();\n    }\n    }\n\n    function smoothScroll() {\n    const galleryItem = document.querySelector('.gallery-item');\n    if (!galleryItem) return;\n\n    const { height: cardHeight } = galleryItem.getBoundingClientRect();\n\n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n    });\n    }"],"names":["galleryList","loader","loadButton","lightbox","SimpleLightbox","createGallery","images","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","BASEURL","API","PER_PAGE","getImagesByQuery","query","page","data","axios","form","userInput","loadMoreButton","currentQuery","totalHits","handleFormSubmit","handleLoadMore","event","newQuery","iziToast","renderGallery","response","hits","newTotal","smoothScroll","error","galleryItem","cardHeight"],"mappings":"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"}